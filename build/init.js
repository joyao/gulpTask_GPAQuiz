"use strict";var SubjectObj=[{id:"subject1",name:"法規課程",info:"政府採購法之總則、招標及決標：是非 12 題；選擇 24 題<br>政府採購法之履約管理及驗收：是非 2 題；選擇 4 題<br>政府採購法之罰則及附則：是非 5 題；選擇 10 題<br>政府採購法之爭議處理：是非 4 題；選擇 8 題<br>是非：1 分/題；選擇：2 分/題",wsurl_MC:"https://script.google.com/macros/s/AKfycbw0cUYsP3gh3ypDIGIYjgoyszlsKvX88BjWSsw6urE7pYFNdho/exec",wsurl_TF:"https://script.google.com/macros/s/AKfycbwIKPgNzq2ooLh9wXzFru9_Q-Ja9AUV-m70WcECgQ/exec"},{id:"subject2",name:"實務課程",info:"工程及技術服務採購作業：是非 6 題；選擇 12 題<br>財物及勞務採購作業：是非 6 題；選擇 12 題<br>最有利標及評選優勝廠商：是非 6 題；選擇 12 題<br>電子採購實務：是非 6 題；選擇 12 題<br>是非：1 分/題；選擇：2 分/題",wsurl_MC:"https://script.google.com/macros/s/AKfycbzeaFLCgUwYfWGc0rxL3a1Un3NNIAKH6VncVg31rQ/exec",wsurl_TF:"https://script.google.com/macros/s/AKfycbyTrHsOgcLDKc5VrEYtHLy-gK-NXbKRuRxVsUcG/exec"},{id:"subject3",name:"其他課程",info:"錯誤採購態樣：是非 2 題；選擇 4 題<br>投標須知及招標文件製作：是非 4 題；選擇 8 題<br>採購契約：是非 4 題；選擇 8 題<br>底價及價格分析：是非 3 題；選擇 6 題<br>政府採購全生命週期概論：是非 4 題；選擇 8 題<br>道德規範及違法處置：是非 2 題；選擇 4 題<br>是非：1 分/題；選擇：2 分/題",wsurl_MC:"https://script.google.com/macros/s/AKfycbx5sKlLicMgexWN46sGVFVWf6FmR17A3zMAGmykbA/exec",wsurl_TF:"https://script.google.com/macros/s/AKfycbyo_NdhoXQbrO8NK2f2CWd-ocG39llm5N03JWFnkw/exec"}];function Quiz_MultipleChoice(i,e,t,a,s,r,l,d){this.id=i,this.question=e,this.option1=t,this.option2=a,this.option3=s,this.option4=r,this.answer=l,this.detail=d}function Quiz_TrueFalse(i,e,t,a,s,r){this.id=i,this.question=e,this.option1=t,this.option2=a,this.answer=s,this.detail=r}var QuizArr=[];function getQuestions(e,r){$("#quiztable").html(""),$("#quizscore").html(""),$("#submitQuiz").hide(),$("#reQuiz").hide(),$(".loader").fadeIn();var i=SubjectObj.filter(function(i){return i.id===e})[0];$("#subjecttitle").attr("qvalue",e),$("#subjecttitle").attr("qtype",r),QuizArr=[];var t=i.wsurl_MC;"MC"===r?(t=i.wsurl_MC,$("#subjecttitle").html(i.name+"-選擇題 模擬試題")):"TF"===r&&(t=i.wsurl_TF,$("#subjecttitle").html(i.name+"-是非題 模擬試題")),$("#subjectinfo").html(i.info),$.getJSON(t,function(i){console.log(i);var s="";$.each(i,function(i,e){var t,a;"MC"===r?(t=new Quiz_MultipleChoice("Q"+e.index,e.data[2],e.data[3],e.data[4],e.data[5],e.data[6],e.data[1],e.data[7].toString().replace(/\n/g,"<br>")),QuizArr.push(t),a='<div id="'+t.id+'" class="ui form">                              <div class="grouped fields">                                <label>'+t.id+". "+t.question+'</label>                                <div class="field">                                  <div class="ui radio checkbox">                                    <input type="radio" name="'+t.id+'" value="1">                                    <label>'+t.option1+'</label>                                  </div>                                </div>                                <div class="field">                                  <div class="ui radio checkbox">                                    <input type="radio" name="'+t.id+'" value="2">                                    <label>'+t.option2+'</label>                                  </div>                                </div>                                <div class="field">                                  <div class="ui radio checkbox">                                    <input type="radio" name="'+t.id+'" value="3">                                    <label>'+t.option3+'</label>                                  </div>                                </div>                                <div class="field">                                  <div class="ui radio checkbox">                                    <input type="radio" name="'+t.id+'" value="4">                                    <label>'+t.option4+'</label>                                  </div>                                </div>                              </div>                              <div class="ui hidden message detailanswer">                              </div>                            </div>'):"TF"===r&&(t=new Quiz_TrueFalse("Q"+e.index,e.data[2],e.data[3],e.data[4],e.data[1],e.data[5].toString().replace(/\n/g,"<br>")),QuizArr.push(t),a='<div id="'+t.id+'" class="ui form">                              <div class="grouped fields">                                <label>'+t.id+". "+t.question+'</label>                                <div class="field">                                  <div class="ui radio checkbox">                                    <input type="radio" name="'+t.id+'" value="1">                                    <label>'+t.option1+'</label>                                  </div>                                </div>                                <div class="field">                                  <div class="ui radio checkbox">                                    <input type="radio" name="'+t.id+'" value="2">                                    <label>'+t.option2+'</label>                                  </div>                                </div>                              </div>                              <div class="ui hidden message detailanswer">                              </div>                            </div>'),s+="<tr><td>"+a+"</td></tr>"}),$("#quiztable").show(),$("#submitQuiz").show(),$("#quiztable").html(s),$(".loader").fadeOut()})}function submitQuiz(){var s,r=$("#subjecttitle").attr("qtype");$("#quiztable input:checked").length===QuizArr.length?confirm("確定提交？")&&($(".ui.checkbox").checkbox("set disabled"),s=0,QuizArr.forEach(function(i,e){if(0===$("#"+i.id+" input:checked").length)return alert("請填寫完整"),!1;var t=$("#"+i.id+" input:checked")[0].value,a=i.answer;$("#"+i.id+" .detailanswer");t.toString()===a.toString()?($("#"+i.id+" .detailanswer").addClass("positive"),$("#"+i.id+" .detailanswer").html("詳解：<br>"+i.detail),"MC"===r?s+=2:"TF"===r&&(s+=1)):($("#"+i.id+" label").css("color","red"),$("#"+i.id+" .detailanswer").addClass("negative"),"MC"===r?$("#"+i.id+" .detailanswer").html("答案為：("+i.answer+")<br>詳解：<br>"+i.detail):"TF"===r&&$("#"+i.id+" .detailanswer").html("答案為：("+("1"===i.answer.toString()?"O":"X")+")<br>詳解：<br>"+i.detail)),e===QuizArr.length-1&&("MC"===r?$("#quizscore").html("分數："+s.toString()+"/"+(2*QuizArr.length).toString()+" = "+(s/(2*QuizArr.length)*100).toFixed(2).toString()+"%"):"TF"===r&&$("#quizscore").html("分數："+s.toString()+"/"+QuizArr.length.toString()+" = "+(s/QuizArr.length*100).toFixed(2).toString()+"%"),$("#quizscore").show(),$(".ui.message.detailanswer").removeClass("hidden"),$("#submitQuiz").hide(),$("#reQuiz").show(),$("html,body").animate({scrollTop:0},500))})):QuizArr.every(function(i,e,t){return 0!==$("#"+i.id+" input:checked").length||void $("html, body").animate({scrollTop:$("#"+i.id).offset().top-$("#subjecttitle").offset().top},1e3)})}function reQuiz(){$("#quizscore").html(""),$("#reQuiz").hide(),getQuestions($("#subjecttitle").attr("qvalue"),$("#subjecttitle").attr("qtype"))}